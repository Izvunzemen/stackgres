{
    "apiVersion": "apps/v1",
    "kind": "StatefulSet",
    "metadata": {
        "creationTimestamp": "2021-12-17T11:01:19Z",
        "generation": 1,
        "labels": {
            "app": "StackGresDistributedLogs",
            "distributed-logs-name": "distributedlogs",
            "distributed-logs-uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
        },
        "name": "distributedlogs",
        "namespace": "dbops-security-upgrade-61bc6d8a",
        "ownerReferences": [
            {
                "apiVersion": "stackgres.io/v1beta1",
                "controller": true,
                "kind": "SGDistributedLogs",
                "name": "distributedlogs",
                "uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
            }
        ],
        "resourceVersion": "296061",
        "selfLink": "/apis/apps/v1/namespaces/dbops-security-upgrade-61bc6d8a/statefulsets/distributedlogs",
        "uid": "7c89afdd-ca91-462b-808c-7d8efbc2c650"
    },
    "spec": {
        "podManagementPolicy": "OrderedReady",
        "replicas": 1,
        "revisionHistoryLimit": 10,
        "selector": {
            "matchLabels": {
                "app": "StackGresDistributedLogs",
                "cluster": "true",
                "disruptible": "true",
                "distributed-logs-name": "distributedlogs",
                "distributed-logs-uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
            }
        },
        "serviceName": "distributedlogs",
        "template": {
            "metadata": {
                "annotations": {
                    "stackgres.io/operatorVersion": "0.9.5"
                },
                "creationTimestamp": null,
                "labels": {
                    "app": "StackGresDistributedLogs",
                    "cluster": "true",
                    "disruptible": "true",
                    "distributed-logs-name": "distributedlogs",
                    "distributed-logs-uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
                }
            },
            "spec": {
                "containers": [
                    {
                        "command": [
                            "/bin/sh",
                            "-ex",
                            "/usr/local/bin/start-patroni.sh"
                        ],
                        "env": [
                            {
                                "name": "ETC_PASSWD_PATH",
                                "value": "/etc/passwd"
                            },
                            {
                                "name": "ETC_GROUP_PATH",
                                "value": "/etc/group"
                            },
                            {
                                "name": "ETC_SHADOW_PATH",
                                "value": "/etc/shadow"
                            },
                            {
                                "name": "ETC_GSHADOW_PATH",
                                "value": "/etc/gshadow"
                            },
                            {
                                "name": "LOCAL_BIN_PATH",
                                "value": "/usr/local/bin"
                            },
                            {
                                "name": "LOCAL_BIN_SHELL_UTILS_PATH",
                                "value": "/usr/local/bin/shell-utils"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_DATA_PATHS_SH_PATH",
                                "value": "/usr/local/bin/setup-data-paths.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_ARBITRARY_USER_SH_PATH",
                                "value": "/usr/local/bin/setup-arbitrary-user.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_SCRIPTS_SH_PATH",
                                "value": "/usr/local/bin/setup-scripts.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_SH_PATH",
                                "value": "/usr/local/bin/start-patroni.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_WITH_RESTORE_SH_PATH",
                                "value": "/usr/local/bin/start-patroni-with-restore.sh"
                            },
                            {
                                "name": "LOCAL_BIN_POST_INIT_SH_PATH",
                                "value": "/usr/local/bin/post-init.sh"
                            },
                            {
                                "name": "LOCAL_BIN_EXEC_WITH_ENV_PATH",
                                "value": "/usr/local/bin/exec-with-env"
                            },
                            {
                                "name": "LOCAL_BIN_CREATE_BACKUP_SH_PATH",
                                "value": "/usr/local/bin/create-backup.sh"
                            },
                            {
                                "name": "PG_BASE_PATH",
                                "value": "/var/lib/postgresql"
                            },
                            {
                                "name": "PG_DATA_PATH",
                                "value": "/var/lib/postgresql/data"
                            },
                            {
                                "name": "PG_RUN_PATH",
                                "value": "/var/run/postgresql"
                            },
                            {
                                "name": "PG_LOG_PATH",
                                "value": "/var/log/postgresql"
                            },
                            {
                                "name": "BASE_ENV_PATH",
                                "value": "/etc/env"
                            },
                            {
                                "name": "SHARED_MEMORY_PATH",
                                "value": "/dev/shm"
                            },
                            {
                                "name": "BASE_SECRET_PATH",
                                "value": "/etc/env/.secret"
                            },
                            {
                                "name": "PATRONI_ENV_PATH",
                                "value": "/etc/env/patroni"
                            },
                            {
                                "name": "PATRONI_CONFIG_PATH",
                                "value": "/etc/patroni"
                            },
                            {
                                "name": "BACKUP_ENV_PATH",
                                "value": "/etc/env/backup"
                            },
                            {
                                "name": "BACKUP_SECRET_PATH",
                                "value": "/etc/env/.secret/backup"
                            },
                            {
                                "name": "RESTORE_ENV_PATH",
                                "value": "/etc/env/restore"
                            },
                            {
                                "name": "RESTORE_SECRET_PATH",
                                "value": "/etc/env/.secret/restore"
                            },
                            {
                                "name": "TEMPLATES_PATH",
                                "value": "/templates"
                            },
                            {
                                "name": "PATRONI_ENV",
                                "value": "patroni"
                            },
                            {
                                "name": "BACKUP_ENV",
                                "value": "backup"
                            },
                            {
                                "name": "RESTORE_ENV",
                                "value": "restore"
                            },
                            {
                                "name": "POSTGRES_ENTRY_PORT",
                                "value": "7432"
                            },
                            {
                                "name": "POSTGRES_REPL_ENTRY_PORT",
                                "value": "7433"
                            },
                            {
                                "name": "POSTGRES_POOL_PORT",
                                "value": "6432"
                            },
                            {
                                "name": "POSTGRES_PORT",
                                "value": "5432"
                            },
                            {
                                "name": "PATRONI_RESTAPI_LISTEN",
                                "value": "0.0.0.0:8008"
                            },
                            {
                                "name": "PATRONI_RESTAPI_CONNECT_ADDRESS",
                                "value": "${PATRONI_KUBERNETES_POD_IP}:8008"
                            },
                            {
                                "name": "PATRONI_RESTAPI_USERNAME",
                                "value": "superuser"
                            },
                            {
                                "name": "PATRONI_RESTAPI_PASSWORD",
                                "valueFrom": {
                                    "secretKeyRef": {
                                        "key": "restapi-password",
                                        "name": "distributedlogs"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_NAME",
                                "valueFrom": {
                                    "fieldRef": {
                                        "apiVersion": "v1",
                                        "fieldPath": "metadata.name"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_KUBERNETES_NAMESPACE",
                                "valueFrom": {
                                    "fieldRef": {
                                        "apiVersion": "v1",
                                        "fieldPath": "metadata.namespace"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_KUBERNETES_POD_IP",
                                "valueFrom": {
                                    "fieldRef": {
                                        "apiVersion": "v1",
                                        "fieldPath": "status.podIP"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_SUPERUSER_PASSWORD",
                                "valueFrom": {
                                    "secretKeyRef": {
                                        "key": "superuser-password",
                                        "name": "distributedlogs"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_REPLICATION_PASSWORD",
                                "valueFrom": {
                                    "secretKeyRef": {
                                        "key": "replication-password",
                                        "name": "distributedlogs"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_authenticator_PASSWORD",
                                "valueFrom": {
                                    "secretKeyRef": {
                                        "key": "authenticator-password",
                                        "name": "distributedlogs"
                                    }
                                }
                            },
                            {
                                "name": "PATRONI_authenticator_OPTIONS",
                                "value": "superuser"
                            }
                        ],
                        "envFrom": [
                            {
                                "configMapRef": {
                                    "name": "distributedlogs"
                                }
                            }
                        ],
                        "image": "docker.io/ongres/patroni-ext:v1.6.5-pg12.6-build-6.0",
                        "imagePullPolicy": "IfNotPresent",
                        "livenessProbe": {
                            "failureThreshold": 6,
                            "httpGet": {
                                "path": "/cluster",
                                "port": 8008,
                                "scheme": "HTTP"
                            },
                            "initialDelaySeconds": 15,
                            "periodSeconds": 20,
                            "successThreshold": 1,
                            "timeoutSeconds": 1
                        },
                        "name": "patroni",
                        "ports": [
                            {
                                "containerPort": 5432,
                                "name": "pgport",
                                "protocol": "TCP"
                            },
                            {
                                "containerPort": 8008,
                                "name": "patroniport",
                                "protocol": "TCP"
                            }
                        ],
                        "readinessProbe": {
                            "failureThreshold": 3,
                            "httpGet": {
                                "path": "/read-only",
                                "port": 8008,
                                "scheme": "HTTP"
                            },
                            "initialDelaySeconds": 5,
                            "periodSeconds": 10,
                            "successThreshold": 1,
                            "timeoutSeconds": 1
                        },
                        "resources": {},
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/var/lib/postgresql",
                                "name": "distributedlogs-data"
                            },
                            {
                                "mountPath": "/var/run/postgresql",
                                "name": "socket"
                            },
                            {
                                "mountPath": "/dev/shm",
                                "name": "dshm"
                            },
                            {
                                "mountPath": "/usr/local/bin",
                                "name": "local",
                                "subPath": "usr/local/bin"
                            },
                            {
                                "mountPath": "/var/log/postgresql",
                                "name": "local",
                                "subPath": "var/log/postgresql"
                            },
                            {
                                "mountPath": "/etc/passwd",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/passwd"
                            },
                            {
                                "mountPath": "/etc/group",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/group"
                            },
                            {
                                "mountPath": "/etc/shadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/shadow"
                            },
                            {
                                "mountPath": "/etc/gshadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/gshadow"
                            },
                            {
                                "mountPath": "/etc/env/patroni",
                                "name": "patroni-env"
                            },
                            {
                                "mountPath": "/etc/patroni",
                                "name": "patroni-config"
                            },
                            {
                                "mountPath": "/etc/env/backup",
                                "name": "backup-env"
                            },
                            {
                                "mountPath": "/etc/env/.secret/backup",
                                "name": "backup-secret"
                            },
                            {
                                "mountPath": "/etc/patroni/init-script.d/00000-distributed-logs-template.template1.sql",
                                "name": "distributedlogs-00000-distributed-logs-template-template1",
                                "readOnly": true,
                                "subPath": "00000-distributed-logs-template.template1.sql"
                            }
                        ]
                    },
                    {
                        "args": [
                            "echo 'Wait for postgres to be up, running and initialized!'\nuntil curl -s localhost:8008/read-only --fail \u003e /dev/null; do sleep 1; done\nCONFIG_PATH=/etc/fluentd\nupdate_config() {\n  rm -Rf /tmp/last_config\n  cp -Lr \"$CONFIG_PATH\" /tmp/last_config\n}\n\nhas_config_changed() {\n  for file in $(ls -1 \"$CONFIG_PATH\")\n  do\n    [ \"$(cat \"$CONFIG_PATH/$file\" | md5sum)\" \\\n      != \"$(cat \"/tmp/last_config/$file\" | md5sum)\" ] \\\n      \u0026\u0026 return || true\n  done\n  return 1\n}\n\nrun_fluentd() {\n  set -x\n  for database in $(cat \"$CONFIG_PATH/databases\")\n  do\n    echo \"Create database ${database} if not exists\"\n    cat \u003c\u003c EOF | ruby -e '\nrequire \"pg\"\nconn = PG.connect(host: \"/var/run/postgresql\", port: 5432, user: \"postgres\", dbname: \"postgres\")\nconn.exec(STDIN.read)'\nCREATE EXTENSION IF NOT EXISTS dblink;\nDO\n\\$do\\$\nBEGIN\n   IF EXISTS (SELECT FROM pg_database WHERE datname = '${database}') THEN\n      RAISE NOTICE 'Database ${database} already exists';\n   ELSE\n     PERFORM dblink_exec('host=/var/run/postgresql port=5432 user=postgres dbname=' || current_database(), 'CREATE DATABASE \"${database}\"');\n   END IF;\nEND\n\\$do\\$;\nEOF\n  done\n  exec /usr/local/bin/fluentd \\\n    -c \"$CONFIG_PATH/fluentd.conf\"\n}\n\nset +x\nwhile true\ndo\n  if has_config_changed || [ ! -d \"/proc/$PID\" ]\n  then\n    echo 'Configuration has changed, restarting fluentd'\n    update_config\n    if [ -n \"$PID\" ]\n    then\n      kill \"$PID\" || true\n      wait \"$PID\" || true\n    fi\n    run_fluentd \u0026\n    PID=\"$!\"\n  fi\n  sleep 5\ndone\n"
                        ],
                        "command": [
                            "/bin/sh",
                            "-exc"
                        ],
                        "image": "docker.io/ongres/fluentd:v1.9.3-build-6.0",
                        "imagePullPolicy": "IfNotPresent",
                        "livenessProbe": {
                            "failureThreshold": 6,
                            "initialDelaySeconds": 15,
                            "periodSeconds": 20,
                            "successThreshold": 1,
                            "tcpSocket": {
                                "port": 12225
                            },
                            "timeoutSeconds": 1
                        },
                        "name": "fluentd",
                        "ports": [
                            {
                                "containerPort": 12225,
                                "name": "fluentd-forward",
                                "protocol": "TCP"
                            }
                        ],
                        "readinessProbe": {
                            "failureThreshold": 3,
                            "initialDelaySeconds": 5,
                            "periodSeconds": 10,
                            "successThreshold": 1,
                            "tcpSocket": {
                                "port": 12225
                            },
                            "timeoutSeconds": 1
                        },
                        "resources": {},
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/var/run/postgresql",
                                "name": "socket"
                            },
                            {
                                "mountPath": "/etc/fluentd",
                                "name": "fluentd",
                                "readOnly": true
                            },
                            {
                                "mountPath": "/etc/passwd",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/passwd"
                            },
                            {
                                "mountPath": "/etc/group",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/group"
                            },
                            {
                                "mountPath": "/etc/shadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/shadow"
                            },
                            {
                                "mountPath": "/etc/gshadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/gshadow"
                            }
                        ]
                    }
                ],
                "dnsPolicy": "ClusterFirst",
                "initContainers": [
                    {
                        "command": [
                            "/bin/sh",
                            "-ex",
                            "/templates/setup-arbitrary-user.sh"
                        ],
                        "env": [
                            {
                                "name": "ETC_PASSWD_PATH",
                                "value": "/etc/passwd"
                            },
                            {
                                "name": "ETC_GROUP_PATH",
                                "value": "/etc/group"
                            },
                            {
                                "name": "ETC_SHADOW_PATH",
                                "value": "/etc/shadow"
                            },
                            {
                                "name": "ETC_GSHADOW_PATH",
                                "value": "/etc/gshadow"
                            },
                            {
                                "name": "LOCAL_BIN_PATH",
                                "value": "/usr/local/bin"
                            },
                            {
                                "name": "LOCAL_BIN_SHELL_UTILS_PATH",
                                "value": "/usr/local/bin/shell-utils"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_DATA_PATHS_SH_PATH",
                                "value": "/usr/local/bin/setup-data-paths.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_ARBITRARY_USER_SH_PATH",
                                "value": "/usr/local/bin/setup-arbitrary-user.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_SCRIPTS_SH_PATH",
                                "value": "/usr/local/bin/setup-scripts.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_SH_PATH",
                                "value": "/usr/local/bin/start-patroni.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_WITH_RESTORE_SH_PATH",
                                "value": "/usr/local/bin/start-patroni-with-restore.sh"
                            },
                            {
                                "name": "LOCAL_BIN_POST_INIT_SH_PATH",
                                "value": "/usr/local/bin/post-init.sh"
                            },
                            {
                                "name": "LOCAL_BIN_EXEC_WITH_ENV_PATH",
                                "value": "/usr/local/bin/exec-with-env"
                            },
                            {
                                "name": "LOCAL_BIN_CREATE_BACKUP_SH_PATH",
                                "value": "/usr/local/bin/create-backup.sh"
                            },
                            {
                                "name": "PG_BASE_PATH",
                                "value": "/var/lib/postgresql"
                            },
                            {
                                "name": "PG_DATA_PATH",
                                "value": "/var/lib/postgresql/data"
                            },
                            {
                                "name": "PG_RUN_PATH",
                                "value": "/var/run/postgresql"
                            },
                            {
                                "name": "PG_LOG_PATH",
                                "value": "/var/log/postgresql"
                            },
                            {
                                "name": "BASE_ENV_PATH",
                                "value": "/etc/env"
                            },
                            {
                                "name": "SHARED_MEMORY_PATH",
                                "value": "/dev/shm"
                            },
                            {
                                "name": "BASE_SECRET_PATH",
                                "value": "/etc/env/.secret"
                            },
                            {
                                "name": "PATRONI_ENV_PATH",
                                "value": "/etc/env/patroni"
                            },
                            {
                                "name": "PATRONI_CONFIG_PATH",
                                "value": "/etc/patroni"
                            },
                            {
                                "name": "BACKUP_ENV_PATH",
                                "value": "/etc/env/backup"
                            },
                            {
                                "name": "BACKUP_SECRET_PATH",
                                "value": "/etc/env/.secret/backup"
                            },
                            {
                                "name": "RESTORE_ENV_PATH",
                                "value": "/etc/env/restore"
                            },
                            {
                                "name": "RESTORE_SECRET_PATH",
                                "value": "/etc/env/.secret/restore"
                            },
                            {
                                "name": "TEMPLATES_PATH",
                                "value": "/templates"
                            },
                            {
                                "name": "PATRONI_ENV",
                                "value": "patroni"
                            },
                            {
                                "name": "BACKUP_ENV",
                                "value": "backup"
                            },
                            {
                                "name": "RESTORE_ENV",
                                "value": "restore"
                            },
                            {
                                "name": "POSTGRES_ENTRY_PORT",
                                "value": "7432"
                            },
                            {
                                "name": "POSTGRES_REPL_ENTRY_PORT",
                                "value": "7433"
                            },
                            {
                                "name": "POSTGRES_POOL_PORT",
                                "value": "6432"
                            },
                            {
                                "name": "POSTGRES_PORT",
                                "value": "5432"
                            }
                        ],
                        "image": "busybox:1.31.1",
                        "imagePullPolicy": "IfNotPresent",
                        "name": "setup-arbitrary-user",
                        "resources": {},
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/templates",
                                "name": "templates"
                            },
                            {
                                "mountPath": "/local/etc",
                                "name": "local",
                                "subPath": "etc"
                            }
                        ]
                    },
                    {
                        "command": [
                            "/bin/sh",
                            "-ex",
                            "/templates/setup-data-paths.sh"
                        ],
                        "env": [
                            {
                                "name": "ETC_PASSWD_PATH",
                                "value": "/etc/passwd"
                            },
                            {
                                "name": "ETC_GROUP_PATH",
                                "value": "/etc/group"
                            },
                            {
                                "name": "ETC_SHADOW_PATH",
                                "value": "/etc/shadow"
                            },
                            {
                                "name": "ETC_GSHADOW_PATH",
                                "value": "/etc/gshadow"
                            },
                            {
                                "name": "LOCAL_BIN_PATH",
                                "value": "/usr/local/bin"
                            },
                            {
                                "name": "LOCAL_BIN_SHELL_UTILS_PATH",
                                "value": "/usr/local/bin/shell-utils"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_DATA_PATHS_SH_PATH",
                                "value": "/usr/local/bin/setup-data-paths.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_ARBITRARY_USER_SH_PATH",
                                "value": "/usr/local/bin/setup-arbitrary-user.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_SCRIPTS_SH_PATH",
                                "value": "/usr/local/bin/setup-scripts.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_SH_PATH",
                                "value": "/usr/local/bin/start-patroni.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_WITH_RESTORE_SH_PATH",
                                "value": "/usr/local/bin/start-patroni-with-restore.sh"
                            },
                            {
                                "name": "LOCAL_BIN_POST_INIT_SH_PATH",
                                "value": "/usr/local/bin/post-init.sh"
                            },
                            {
                                "name": "LOCAL_BIN_EXEC_WITH_ENV_PATH",
                                "value": "/usr/local/bin/exec-with-env"
                            },
                            {
                                "name": "LOCAL_BIN_CREATE_BACKUP_SH_PATH",
                                "value": "/usr/local/bin/create-backup.sh"
                            },
                            {
                                "name": "PG_BASE_PATH",
                                "value": "/var/lib/postgresql"
                            },
                            {
                                "name": "PG_DATA_PATH",
                                "value": "/var/lib/postgresql/data"
                            },
                            {
                                "name": "PG_RUN_PATH",
                                "value": "/var/run/postgresql"
                            },
                            {
                                "name": "PG_LOG_PATH",
                                "value": "/var/log/postgresql"
                            },
                            {
                                "name": "BASE_ENV_PATH",
                                "value": "/etc/env"
                            },
                            {
                                "name": "SHARED_MEMORY_PATH",
                                "value": "/dev/shm"
                            },
                            {
                                "name": "BASE_SECRET_PATH",
                                "value": "/etc/env/.secret"
                            },
                            {
                                "name": "PATRONI_ENV_PATH",
                                "value": "/etc/env/patroni"
                            },
                            {
                                "name": "PATRONI_CONFIG_PATH",
                                "value": "/etc/patroni"
                            },
                            {
                                "name": "BACKUP_ENV_PATH",
                                "value": "/etc/env/backup"
                            },
                            {
                                "name": "BACKUP_SECRET_PATH",
                                "value": "/etc/env/.secret/backup"
                            },
                            {
                                "name": "RESTORE_ENV_PATH",
                                "value": "/etc/env/restore"
                            },
                            {
                                "name": "RESTORE_SECRET_PATH",
                                "value": "/etc/env/.secret/restore"
                            },
                            {
                                "name": "TEMPLATES_PATH",
                                "value": "/templates"
                            },
                            {
                                "name": "PATRONI_ENV",
                                "value": "patroni"
                            },
                            {
                                "name": "BACKUP_ENV",
                                "value": "backup"
                            },
                            {
                                "name": "RESTORE_ENV",
                                "value": "restore"
                            },
                            {
                                "name": "POSTGRES_ENTRY_PORT",
                                "value": "7432"
                            },
                            {
                                "name": "POSTGRES_REPL_ENTRY_PORT",
                                "value": "7433"
                            },
                            {
                                "name": "POSTGRES_POOL_PORT",
                                "value": "6432"
                            },
                            {
                                "name": "POSTGRES_PORT",
                                "value": "5432"
                            }
                        ],
                        "image": "busybox:1.31.1",
                        "imagePullPolicy": "IfNotPresent",
                        "name": "setup-data-paths",
                        "resources": {},
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/templates",
                                "name": "templates"
                            },
                            {
                                "mountPath": "/var/lib/postgresql",
                                "name": "distributedlogs-data"
                            },
                            {
                                "mountPath": "/etc/passwd",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/passwd"
                            },
                            {
                                "mountPath": "/etc/group",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/group"
                            },
                            {
                                "mountPath": "/etc/shadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/shadow"
                            },
                            {
                                "mountPath": "/etc/gshadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/gshadow"
                            }
                        ]
                    },
                    {
                        "command": [
                            "/bin/sh",
                            "-ex",
                            "/templates/setup-scripts.sh"
                        ],
                        "env": [
                            {
                                "name": "ETC_PASSWD_PATH",
                                "value": "/etc/passwd"
                            },
                            {
                                "name": "ETC_GROUP_PATH",
                                "value": "/etc/group"
                            },
                            {
                                "name": "ETC_SHADOW_PATH",
                                "value": "/etc/shadow"
                            },
                            {
                                "name": "ETC_GSHADOW_PATH",
                                "value": "/etc/gshadow"
                            },
                            {
                                "name": "LOCAL_BIN_PATH",
                                "value": "/usr/local/bin"
                            },
                            {
                                "name": "LOCAL_BIN_SHELL_UTILS_PATH",
                                "value": "/usr/local/bin/shell-utils"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_DATA_PATHS_SH_PATH",
                                "value": "/usr/local/bin/setup-data-paths.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_ARBITRARY_USER_SH_PATH",
                                "value": "/usr/local/bin/setup-arbitrary-user.sh"
                            },
                            {
                                "name": "LOCAL_BIN_SETUP_SCRIPTS_SH_PATH",
                                "value": "/usr/local/bin/setup-scripts.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_SH_PATH",
                                "value": "/usr/local/bin/start-patroni.sh"
                            },
                            {
                                "name": "LOCAL_BIN_START_PATRONI_WITH_RESTORE_SH_PATH",
                                "value": "/usr/local/bin/start-patroni-with-restore.sh"
                            },
                            {
                                "name": "LOCAL_BIN_POST_INIT_SH_PATH",
                                "value": "/usr/local/bin/post-init.sh"
                            },
                            {
                                "name": "LOCAL_BIN_EXEC_WITH_ENV_PATH",
                                "value": "/usr/local/bin/exec-with-env"
                            },
                            {
                                "name": "LOCAL_BIN_CREATE_BACKUP_SH_PATH",
                                "value": "/usr/local/bin/create-backup.sh"
                            },
                            {
                                "name": "PG_BASE_PATH",
                                "value": "/var/lib/postgresql"
                            },
                            {
                                "name": "PG_DATA_PATH",
                                "value": "/var/lib/postgresql/data"
                            },
                            {
                                "name": "PG_RUN_PATH",
                                "value": "/var/run/postgresql"
                            },
                            {
                                "name": "PG_LOG_PATH",
                                "value": "/var/log/postgresql"
                            },
                            {
                                "name": "BASE_ENV_PATH",
                                "value": "/etc/env"
                            },
                            {
                                "name": "SHARED_MEMORY_PATH",
                                "value": "/dev/shm"
                            },
                            {
                                "name": "BASE_SECRET_PATH",
                                "value": "/etc/env/.secret"
                            },
                            {
                                "name": "PATRONI_ENV_PATH",
                                "value": "/etc/env/patroni"
                            },
                            {
                                "name": "PATRONI_CONFIG_PATH",
                                "value": "/etc/patroni"
                            },
                            {
                                "name": "BACKUP_ENV_PATH",
                                "value": "/etc/env/backup"
                            },
                            {
                                "name": "BACKUP_SECRET_PATH",
                                "value": "/etc/env/.secret/backup"
                            },
                            {
                                "name": "RESTORE_ENV_PATH",
                                "value": "/etc/env/restore"
                            },
                            {
                                "name": "RESTORE_SECRET_PATH",
                                "value": "/etc/env/.secret/restore"
                            },
                            {
                                "name": "TEMPLATES_PATH",
                                "value": "/templates"
                            },
                            {
                                "name": "PATRONI_ENV",
                                "value": "patroni"
                            },
                            {
                                "name": "BACKUP_ENV",
                                "value": "backup"
                            },
                            {
                                "name": "RESTORE_ENV",
                                "value": "restore"
                            },
                            {
                                "name": "POSTGRES_ENTRY_PORT",
                                "value": "7432"
                            },
                            {
                                "name": "POSTGRES_REPL_ENTRY_PORT",
                                "value": "7433"
                            },
                            {
                                "name": "POSTGRES_POOL_PORT",
                                "value": "6432"
                            },
                            {
                                "name": "POSTGRES_PORT",
                                "value": "5432"
                            }
                        ],
                        "image": "busybox:1.31.1",
                        "imagePullPolicy": "IfNotPresent",
                        "name": "setup-scripts",
                        "resources": {},
                        "terminationMessagePath": "/dev/termination-log",
                        "terminationMessagePolicy": "File",
                        "volumeMounts": [
                            {
                                "mountPath": "/templates",
                                "name": "templates"
                            },
                            {
                                "mountPath": "/usr/local/bin",
                                "name": "local",
                                "subPath": "usr/local/bin"
                            },
                            {
                                "mountPath": "/etc/passwd",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/passwd"
                            },
                            {
                                "mountPath": "/etc/group",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/group"
                            },
                            {
                                "mountPath": "/etc/shadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/shadow"
                            },
                            {
                                "mountPath": "/etc/gshadow",
                                "name": "local",
                                "readOnly": true,
                                "subPath": "etc/gshadow"
                            }
                        ]
                    }
                ],
                "restartPolicy": "Always",
                "schedulerName": "default-scheduler",
                "securityContext": {
                    "fsGroup": 999,
                    "runAsGroup": 999,
                    "runAsNonRoot": true,
                    "runAsUser": 999
                },
                "serviceAccount": "distributedlogs-patroni",
                "serviceAccountName": "distributedlogs-patroni",
                "shareProcessNamespace": true,
                "terminationGracePeriodSeconds": 60,
                "volumes": [
                    {
                        "emptyDir": {
                            "medium": "Memory"
                        },
                        "name": "socket"
                    },
                    {
                        "emptyDir": {
                            "medium": "Memory"
                        },
                        "name": "dshm"
                    },
                    {
                        "emptyDir": {},
                        "name": "local"
                    },
                    {
                        "configMap": {
                            "defaultMode": 444,
                            "name": "distributedlogs"
                        },
                        "name": "patroni-env"
                    },
                    {
                        "emptyDir": {},
                        "name": "patroni-config"
                    },
                    {
                        "configMap": {
                            "defaultMode": 444,
                            "name": "distributedlogs-backup"
                        },
                        "name": "backup-env"
                    },
                    {
                        "name": "backup-secret",
                        "secret": {
                            "defaultMode": 444,
                            "secretName": "distributedlogs-backup"
                        }
                    },
                    {
                        "configMap": {
                            "defaultMode": 444,
                            "name": "distributedlogs-templates"
                        },
                        "name": "templates"
                    },
                    {
                        "configMap": {
                            "defaultMode": 420,
                            "name": "distributedlogs-00000-distributed-logs-template-template1",
                            "optional": false
                        },
                        "name": "distributedlogs-00000-distributed-logs-template-template1"
                    },
                    {
                        "configMap": {
                            "defaultMode": 420,
                            "name": "distributedlogs-fluentd"
                        },
                        "name": "fluentd"
                    }
                ]
            }
        },
        "updateStrategy": {
            "type": "OnDelete"
        },
        "volumeClaimTemplates": [
            {
                "metadata": {
                    "creationTimestamp": null,
                    "labels": {
                        "app": "StackGresDistributedLogs",
                        "distributed-logs-name": "distributedlogs",
                        "distributed-logs-uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
                    },
                    "name": "distributedlogs-data",
                    "namespace": "dbops-security-upgrade-61bc6d8a",
                    "ownerReferences": [
                        {
                            "apiVersion": "stackgres.io/v1beta1",
                            "controller": true,
                            "kind": "SGDistributedLogs",
                            "name": "distributedlogs",
                            "uid": "928e3aa8-bd80-49e5-b180-bb2cc8298104"
                        }
                    ]
                },
                "spec": {
                    "accessModes": [
                        "ReadWriteOnce"
                    ],
                    "resources": {
                        "requests": {
                            "storage": "128Mi"
                        }
                    },
                    "volumeMode": "Filesystem"
                },
                "status": {
                    "phase": "Pending"
                }
            }
        ]
    }
}
